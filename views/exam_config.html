{% extends "base.html" %}

{% block title %}C·∫•u h√¨nh ƒë·ªÅ thi{% endblock %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/exam.css') }}">
{% endblock %}

{% block content %}
<div class="background"></div>

<div class="container">
    <div class="card">

        <div class="header-form">
            <h2>C·∫•u h√¨nh ƒë·ªÅ thi</h2>
            <span>{{ exam.title }} ‚Äì {{ exam.subject }}</span>
        </div>

        <div class="form-group">
            <p><strong>M√¥n h·ªçc:</strong> {{ exam.subject }}</p>
            <p><strong>Ch·ªß ƒë·ªÅ:</strong> {{ exam.topic if exam.topic else 'Chung' }}</p>
            <p><strong>Ngu·ªìn c√¢u h·ªèi:</strong>
                {% if exam.source_type == 'select' %}Ng√¢n h√†ng
                {% elif exam.source_type == 'excel' %}Excel
                {% endif %}
            </p>
            <p><strong>S·ªë c√¢u h·ªèi:</strong> {{ exam.question_ids | length }}</p>
            <p><strong>Th·ªùi gian:</strong> {{ exam.duration }} ph√∫t</p>
            <p>
                <strong>Tr·∫°ng th√°i:</strong>
                {% if exam.status == 'open' %}
                    <span style="color:#16a34a;font-weight:700">ƒêang m·ªü</span>
                {% else %}
                    <span style="color:#dc2626;font-weight:700">ƒêang ƒë√≥ng</span>
                {% endif %}
            </p>
        </div>

        <div class="form-group">
            <label>üìÑ Danh s√°ch c√¢u h·ªèi trong ƒë·ªÅ</label>
            <div style="max-height:360px; overflow:auto; border:1px solid #e5e7eb; border-radius:12px; padding:16px; background:#f9fafb;">
                {% for q in questions %}
                <div style="margin-bottom:16px">
                    <p><strong>{{ loop.index }}.</strong> {{ q.content }}</p>
                    <ul style="margin-left:20px;font-size:14px">
                        <li>A. {{ q.answers.A }}</li>
                        <li>B. {{ q.answers.B }}</li>
                        <li>C. {{ q.answers.C }}</li>
                        <li>D. {{ q.answers.D }}</li>
                    </ul>
                    <p style="margin-top:6px">
                        <strong style="color:#16a34a">‚úî ƒê√°p √°n ƒë√∫ng: {{ q.correct }}</strong>
                    </p>
                    <hr style="margin-top:12px">
                </div>
                {% else %}
                <p style="color:#888;text-align:center">Kh√¥ng c√≥ c√¢u h·ªèi n√†o trong ƒë·ªÅ</p>
                {% endfor %}
            </div>
        </div>

        <!-- FORM C·∫§U H√åNH -->
        <form method="post">
            <div class="form-group">
                <label>‚è± Th·ªùi gian l√†m b√†i (ph√∫t)</label>
                <input type="number" name="duration" value="{{ exam.duration }}" min="1" required>
            </div>

            <div class="form-group">
                <label>
<input type="checkbox" name="shuffle_questions" value="on" {% if exam.shuffle %}checked{% endif %}>
                    X√°o tr·ªôn th·ª© t·ª± c√¢u h·ªèi
                </label>
            </div>

            <div class="form-group">
                <label>
                    <input type="checkbox" name="show_result" value="on" {% if exam.show_result %}checked{% endif %}>
                    Hi·ªÉn th·ªã k·∫øt qu·∫£ sau khi n·ªôp b√†i
                </label>
            </div>

            <div class="actions">
                <button type="submit" class="btn-save">üíæ L∆∞u c·∫•u h√¨nh</button>
                <a href="{{ url_for('exam.exam_list') }}" class="btn-back">‚¨Ö Quay l·∫°i</a>
            </div>
        </form>

    </div>
</div>
{% endblock %}